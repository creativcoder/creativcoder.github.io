<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.fff28bb22dcbb1b2fd80.css">.icon-module--root--aZeph{display:inline-flex;align-items:center;justify-content:center}.icon-module--icon--1ihz7{fill:currentColor}.icon-module--label--fHC-f{position:relative;display:inline-block;margin-left:4px;line-height:1}.icon-module--left-icon--PqlVL{fill:#fff}.menu-module--mobileMenuContainer--T9wTN{display:none}@media (max-width:683px){.menu-module--mobileMenuContainer--T9wTN{display:flex}}.menu-module--desktopMenuContainer--3iXKR{display:block}@media (max-width:683px){.menu-module--desktopMenuContainer--3iXKR{display:none}}.menu-module--menu--dd4-Y{display:flex;flex:0 0 auto;align-items:center;justify-content:flex-start;max-width:100%;padding:0 15px;list-style:none;border-right:1px solid;margin:0 18px 0 auto}.menu-module--menu--dd4-Y li{margin:0 12px}.menu-module--menuTrigger--32seM{margin-right:10px;padding:0;line-height:0;background:none;color:inherit;border:none;box-shadow:none;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer}.menu-module--menu--dd4-Y a{display:inline-block;margin-right:15px;text-decoration:none}.menu-module--menu--dd4-Y a:last-of-type{margin-right:0}.menu-module--mobileMenu--2VGmR{position:absolute;top:0;right:0;flex-direction:column;align-items:flex-start;background:#fafafa;margin:0;padding:0;text-align:left;list-style:none;border-radius:5px;overflow:hidden;z-index:99}.dark-theme .menu-module--mobileMenu--2VGmR{background:#252627}.menu-module--mobileMenu--2VGmR li{margin:0;white-space:nowrap}.menu-module--mobileMenu--2VGmR li a{display:block;padding:10px 15px}.menu-module--mobileMenuOverlay--2RcSs{position:fixed;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.2);z-index:10}.menu-module--themeToggle--2E8ye{line-height:0;padding:0 5px}.menu-module--subMenuTrigger--1crdm,.menu-module--themeToggle--2E8ye{background:none;color:inherit;border:none;box-shadow:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}.menu-module--subMenuTrigger--1crdm{font-size:inherit;font-weight:inherit;margin:0 12px;padding:0;cursor:pointer}.menu-module--subMenu--3Rgj_{position:absolute;max-width:300px;background:#fafafa;box-shadow:0 8px 20px rgba(0,0,0,.12);margin:0;padding:5px;list-style:none;border-radius:5px;top:35px;right:70px;overflow:hidden;z-index:99}.dark-theme .menu-module--subMenu--3Rgj_{background:#3b3d42}.menu-module--subMenu--3Rgj_ li{text-align:left;margin:0;white-space:nowrap}.menu-module--subMenu--3Rgj_ li a{padding:10px}.menu-module--subMenu--3Rgj_ li:hover{background:rgba(0,0,0,.05);border-radius:3px;cursor:pointer}.dark-theme .menu-module--subMenu--3Rgj_ li:hover{background:rgba(0,0,0,.15)}.menu-module--subMenuOverlay--3TQRy{position:fixed;top:0;bottom:0;left:0;right:0;z-index:-1}.menu-module--menuArrow--1COMf{display:inline-block;font-family:Inter UI;margin-left:5px;transform:rotate(90deg)}.header-module--header--tFeG9{background:#fafafa;display:flex;align-items:center;justify-content:space-between;position:relative;padding:20px}.dark-theme .header-module--header--tFeG9{background:#252627}.header-module--header--tFeG9 a{text-decoration:none}.header-module--inner--7ao1M{justify-content:space-between;margin:0 auto;width:760px;max-width:100%}.header-module--inner--7ao1M,.header-module--logo--2kX-3{display:flex;align-items:center}.header-module--logo--2kX-3{text-decoration:none;font-weight:700;-webkit-animation:header-module--glitch1--1AM4P 2.5s infinite;animation:header-module--glitch1--1AM4P 2.5s infinite}.header-module--logo--2kX-3 img{height:44px}@media (max-width:683px){.header-module--logo--2kX-3 img{height:35px}}.header-module--mark--J6C0c{margin-right:5px}.header-module--cursor--33Aoa{display:inline-block;width:10px;height:1rem;background:#a25cff;margin-left:5px;border-radius:1px;-webkit-animation:header-module--cursor--33Aoa 1s infinite;animation:header-module--cursor--33Aoa 1s infinite}@media (max-width:683px){.header-module--cursor--33Aoa{display:none}}.header-module--mark--J6C0c,.header-module--text--3UAQj{font-size:17px}@media (max-width:683px){.header-module--mark--J6C0c,.header-module--text--3UAQj{font-size:.9rem}}.header-module--right--1Zeb6{display:flex;position:relative}@-webkit-keyframes header-module--cursor--33Aoa{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes header-module--cursor--33Aoa{0%{opacity:0}50%{opacity:1}to{opacity:0}}@-webkit-keyframes header-module--glitch1--1AM4P{0%{transform:none;opacity:1}7%{transform:skew(-.5deg,-.9deg);opacity:.75}10%{transform:none;opacity:1}27%{transform:none;opacity:1}30%{transform:skew(.8deg,-.1deg);opacity:.75}35%{transform:none;opacity:1}52%{transform:none;opacity:1}55%{transform:skew(-.5deg,.2deg);opacity:.75}50%{transform:none;opacity:1}72%{transform:none;opacity:1}75%{transform:skew(.4deg,1deg);opacity:.35}80%{transform:none;opacity:1}to{transform:none;opacity:1}}@keyframes header-module--glitch1--1AM4P{0%{transform:none;opacity:1}7%{transform:skew(-.5deg,-.9deg);opacity:.75}10%{transform:none;opacity:1}27%{transform:none;opacity:1}30%{transform:skew(.8deg,-.1deg);opacity:.75}35%{transform:none;opacity:1}52%{transform:none;opacity:1}55%{transform:skew(-.5deg,.2deg);opacity:.75}50%{transform:none;opacity:1}72%{transform:none;opacity:1}75%{transform:skew(.4deg,1deg);opacity:.35}80%{transform:none;opacity:1}to{transform:none;opacity:1}}footer{padding:1em}@font-face{font-family:Inter UI;font-style:normal;font-weight:400;src:url(/static/Inter-UI-Regular-ecf7c639683dfcb4868861e0c613c455.woff) format("woff")}@font-face{font-family:Inter UI;font-style:italic;font-weight:400;src:url(/static/Inter-UI-Italic-bcf654c7bea165e9dae257206c5521ad.woff) format("woff")}@font-face{font-family:Inter UI;font-style:normal;font-weight:600;src:url(/static/Inter-UI-Medium-48dfecfe37de0ef8f0e2c2d2e6992e9c.woff) format("woff")}@font-face{font-family:Inter UI;font-style:italic;font-weight:600;src:url(/static/Inter-UI-MediumItalic-a9eddc92c84c5f78fba1cb7d7833d31c.woff) format("woff")}@font-face{font-family:Inter UI;font-style:normal;font-weight:800;src:url(/static/Inter-UI-Bold-e2158f600a4b0175b73dfefb0d2fe8f8.woff) format("woff")}@font-face{font-family:Inter UI;font-style:italic;font-weight:800;src:url(/static/Inter-UI-BoldItalic-dbe4ec1d26d41331c91550939a7fd27f.woff) format("woff")}pre[class*=language-],pre[class*=language-]>code{color:#a9a9b3;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#1a1a1d!important;border-radius:8px}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:hsla(0,0%,100%,.35)}.token.punctuation{color:#a9a9b3}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{position:relative;padding-left:65px;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:5px!important;width:3em!important;letter-spacing:-1px;border-right:1px solid;opacity:.5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}div.code-toolbar{position:relative}div.code-toolbar>.toolbar{position:absolute;top:.3em;right:.2em;transition:opacity .3s ease-in-out;opacity:0}div.code-toolbar:hover>.toolbar{opacity:1}div.code-toolbar>.toolbar .toolbar-item{display:inline-block}div.code-toolbar>.toolbar a{cursor:pointer}div.code-toolbar>.toolbar button{background:none;border:0;color:inherit;font:inherit;line-height:normal;overflow:visible;padding:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}div.code-toolbar>.toolbar a,div.code-toolbar>.toolbar button,div.code-toolbar>.toolbar span{color:#bbb;font-size:.8em;padding:0 .5em;background:#f5f2f0;background:hsla(0,0%,87.8%,.2);box-shadow:0 2px 0 0 rgba(0,0,0,.2);border-radius:.5em}div.code-toolbar>.toolbar a:focus,div.code-toolbar>.toolbar a:hover,div.code-toolbar>.toolbar button:focus,div.code-toolbar>.toolbar button:hover,div.code-toolbar>.toolbar span:focus,div.code-toolbar>.toolbar span:hover{color:inherit;text-decoration:none}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}body{margin:0;padding:0;font-family:Inter UI,-apple-system,BlinkMacSystemFont,Roboto,Segoe UI,Helvetica,Arial,sans-serif;font-size:1rem;font-weight:600;line-height:1.54;background-color:#fff;background-repeat:no-repeat;background-attachment:fixed;background-position:50%;background-size:cover;color:#222;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;font-feature-settings:"liga","tnum","case","calt","zero","ss01","locl";-webkit-overflow-scrolling:touch;-webkit-text-size-adjust:100%;transition:background-color .4s}@media (max-width:683px){body{font-size:1rem}}body.dark-theme{background-repeat:no-repeat;background-size:cover;background-attachment:fixed;background-position:50%;background-color:#292a2d;color:#a9a9b3}h1,h2,h3,h4,h5,h6{display:flex;align-items:center;line-height:1.3}h1{font-size:2.625rem}h2{font-size:1.625rem}h3{font-size:1.375rem}h4{font-size:1.125rem}@media (max-width:683px){h1{font-size:2rem}h2{font-size:1.4rem}h3{font-size:1.15rem}h4{font-size:1.125rem}}a{color:inherit}img{display:block;max-width:100%}img.center,img.left{margin-right:auto}img.center,img.right{margin-left:auto}figure{display:table;max-width:100%;margin:25px 0}figure.center,figure.left{margin-right:auto}figure.center,figure.right{margin-left:auto}figure figcaption{font-size:14px;margin-top:5px;opacity:.8}figure figcaption.left{text-align:left}figure figcaption.center{text-align:center}figure figcaption.right{text-align:right}code{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-feature-settings:normal;font-weight:400;background:#eaeaea;padding:1px 6px;margin:0 2px;border-radius:5px;font-size:.9rem}.dark-theme code{background:#3b3d42}pre{background:#1a1a1d;padding:20px;border-radius:8px;font-size:.9rem;overflow:auto}@media (max-width:683px){pre{white-space:pre-wrap;word-wrap:break-word}}pre code{background:none!important;color:#ccc;margin:0;padding:0;font-size:.9rem}blockquote{border-left:2px solid;margin:40px;padding:10px 20px}@media (max-width:683px){blockquote{margin:10px;padding:10px}}blockquote p:first-of-type{margin-top:0}blockquote p:last-of-type{margin-bottom:0}table{table-layout:fixed;border-collapse:collapse;width:100%;margin:40px 0;border-radius:5px}table,td,th{border:1px solid #222;padding:10px}.dark-theme table,.dark-theme td,.dark-theme th{border-color:#a9a9b3}th{background:#eaeaea}.dark-theme th{background:#3b3d42}ol,ul{margin-left:40px;padding:0}@media (max-width:683px){ol,ul{margin-left:20px}}ol ol{list-style-type:lower-alpha}button,input,textarea{font-family:Inter UI,-apple-system,BlinkMacSystemFont,Roboto,Segoe UI,Helvetica,Arial,sans-serif}.container{flex-direction:column;text-align:center}.container,.content{display:flex;justify-content:center}.content{flex-direction:column;flex:1 0 auto;align-items:center;margin:50px auto;width:100%;max-width:800px}@media (max-width:683px){.content{margin-top:0}}@media (max-width:899px){.content{max-width:660px}}hr{width:100%;border:none;background:#dcdcdc;height:1px}.dark-theme hr{background:#4a4b50}.infoBanner{text-align:left;margin:20px 0 40px;padding:10px 20px;border-radius:10px;width:calc(100% - 40px);background:#eaeaea}.dark-theme .infoBanner{background:#3b3d42}.infoBanner span{font-weight:700}@media (max-width:683px){span{font-size:.8rem}}.hidden{display:none}.embedVideo-container{position:relative;padding-bottom:56.25%;height:0;overflow:hidden}.embedVideo-container iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}footer{font-size:1rem;text-align:center;margin-bottom:50px}@media (max-width:683px){footer{display:flex;flex-direction:column}}footer .footerCopyrights:not(:first-of-type){margin-left:20px;padding-left:20px;border-left:1px solid}@media (max-width:683px){footer .footerCopyrights:not(:first-of-type){margin:0;padding:0;border:none}}.navigation-module--navigation--3Zfju{display:flex;width:1024px;max-width:100%;margin:80px 0 40px}.navigation-module--button--28kp3,.navigation-module--navigation--3Zfju{align-items:center;justify-content:center}.navigation-module--button--28kp3{position:relative;display:inline-flex;background:#eaeaea;font-size:1rem;font-weight:700;border-radius:8px;max-width:40%;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.dark-theme .navigation-module--button--28kp3{background:#3b3d42}.navigation-module--button--28kp3+.navigation-module--button--28kp3{margin-left:10px}.navigation-module--button--28kp3 a{display:flex;padding:8px 16px;text-decoration:none}.navigation-module--button--28kp3 a,.navigation-module--buttonText--1Xod2{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.navigation-module--iconNext--3xyJ-{margin-left:8px}.navigation-module--iconPrev--23mg1{margin-right:8px}.post-module--post--28Mq2{width:100%;max-width:800px;text-align:left;padding:20px;margin:0 auto 20px}.post-module--post--28Mq2:not(:last-of-type){border-bottom:1px solid #dcdcdc}.dark-theme .post-module--post--28Mq2:not(:last-of-type){border-color:#4a4b50}@media (max-width:899px){.post-module--post--28Mq2{max-width:660px}}.post-module--post--28Mq2 h1{margin:0 0 10px}.post-module--post--28Mq2 img{border-radius:8px}.post-module--title--3XBo2 a{text-decoration:none}.post-module--coverImage--1GM7V{border-radius:8px;margin-bottom:40px;box-shadow:0 15px 30px rgba(0,0,0,.1)}.post-module--meta--3YtjE{font-size:1rem;margin-bottom:30px}.post-module--tags--3RbqF{margin-top:10px;opacity:.5}.post-module--tag--16U9p{margin-right:10px}.post-module--readMore--3zWML,.post-module--tag--16U9p{display:inline-block}.post-module--readMore--3zWML{text-decoration:none;font-weight:700;margin:20px 0;font-size:1rem}.post-module--postContent--1bfnt{position:relative}</style><meta name="generator" content="Gatsby 2.23.20"/><title data-react-helmet="true">How to run Rust on Arduino Uno - Our first blink ðŸ’¡ :: /creativcoder</title><meta data-react-helmet="true" name="description" content="A whirlwind tour on quickly getting up and running with Rust on Arduino"/><meta data-react-helmet="true" property="og:title" content="How to run Rust on Arduino Uno - Our first blink ðŸ’¡"/><meta data-react-helmet="true" property="og:description" content="A whirlwind tour on quickly getting up and running with Rust on Arduino"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="How to run Rust on Arduino Uno - Our first blink ðŸ’¡"/><meta data-react-helmet="true" name="twitter:description" content="A whirlwind tour on quickly getting up and running with Rust on Arduino"/><meta data-react-helmet="true" name="twitter:creator" content="@panr"/><meta data-react-helmet="true" name="keywords" content="gatsby, minimal, starter, blog, theme, dark, light, personal site"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#a2466c"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><link rel="icon" href="/favicon-32x32.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#292a2d"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=783c1f9b075b74edf07c934d2be96390"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=783c1f9b075b74edf07c934d2be96390"/><link as="script" rel="preload" href="/webpack-runtime-0d2cb20de6c72e8ed401.js"/><link as="script" rel="preload" href="/framework-f2db165fb1960f050581.js"/><link as="script" rel="preload" href="/app-b48090a5057dc339fe46.js"/><link as="script" rel="preload" href="/styles-0dd9b16d06f2e4f550cc.js"/><link as="script" rel="preload" href="/commons-23c2adbaf89b8510e10b.js"/><link as="script" rel="preload" href="/23c3d3a3a2879427593569aafa02d04d4d5b9e2a-02d3ce6bc7398bea4d02.js"/><link as="script" rel="preload" href="/component---src-templates-page-js-dbf26a7cadf695539444.js"/><link as="fetch" rel="preload" href="/page-data/rust-on-arduino-uno/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light-theme"><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="container"><header class="header-module--header--tFeG9"><div class="header-module--inner--7ao1M"><a href="/"><div class="header-module--logo--2kX-3"><img class="light-theme" src="creativcoder_dark.svg" alt="logo"/>Â <span class="header-module--text--3UAQj">&gt; creativcoder.dev</span><span class="header-module--cursor--33Aoa"></span></div></a><span class="header-module--right--1Zeb6"><div class="menu-module--mobileMenuContainer--T9wTN"><button class="menu-module--menuTrigger--32seM" style="color:inherit" type="button" aria-label="Menu"><span class="icon-module--root--aZeph" style="cursor:pointer" role="figure"><svg version="1.1" width="24" height="24" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M4 34H40V30H4V34ZM4 24H40V20H4V24ZM4 10V14H40V10H4Z" class="icon-module--icon--1ihz7"></path></svg></span></button></div><div class="menu-module--desktopMenuContainer--3iXKR"><ul class="menu-module--menu--dd4-Y"><li><a href="/whoami">whoami</a></li><li><a href="/open-source">open-source</a></li><li><a href="/talks">talks</a></li><li><a href="/publications">publications</a></li></ul></div><button class="menu-module--themeToggle--2E8ye" type="button" aria-label="Theme toggle"><span class="icon-module--root--aZeph" style="cursor:pointer" role="figure"><svg version="1.1" width="24" height="24" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z" class="icon-module--icon--1ihz7"></path></svg></span></button></span></div></header><div class="content"><div class="post-module--post--28Mq2"><div class="post-module--postContent--1bfnt"><h1 class="post-module--title--3XBo2">How to run Rust on Arduino Uno - Our first blink ðŸ’¡</h1><div class="post-module--meta--3YtjE">19 August 2020<div class="post-module--tags--3RbqF"><a href="/tag/rust/"><span class="post-module--tag--16U9p">#<!-- -->rust</span></a><a href="/tag/arduino/"><span class="post-module--tag--16U9p">#<!-- -->arduino</span></a><a href="/tag/uno/"><span class="post-module--tag--16U9p">#<!-- -->uno</span></a><a href="/tag/embedded/"><span class="post-module--tag--16U9p">#<!-- -->embedded</span></a><a href="/tag/blink/"><span class="post-module--tag--16U9p">#<!-- -->blink</span></a></div></div><div><p><img src="https://images.unsplash.com/photo-1597792134982-4afde30f32fa?ixlib=rb-1.2.1&#x26;q=80&#x26;fm=jpg&#x26;crop=entropy&#x26;cs=tinysrgb&#x26;dl=creativcoder-CbLyJEh23rA-unsplash.jpg&#x26;w=1920"></p>
<p>At the time of writing this, about a month ago, the rust-avr fork was merged <a href="https://github.com/rust-lang/rust/issues/44052#issuecomment-663394401">upstream</a>. This means that you can now compile Rust programs for the avr microcontroller board by just running <code class="language-text">cargo +nightly build</code>, providing a <code class="language-text">.cargo/config.toml</code> for your target (<code class="language-text">avr-unknown-unknown</code>). That's huge!</p>
<p>I have always been fascinated with the idea of using code to manipulate and affect physical objects. This is probably going to be a series of blog posts on my adventures with Rust on Arduino and maybe ESP8266 and discovery F3 in future. (I have these lying around too). Kicking off the series with this first post.</p>
<hr>
<p><em>Target audience</em>: This post is written with beginner to intermediate folks in mind who want a head start with embedded systems in Rust with Arduino. Once you have gone through this post, you may wanna go through the through the basics on <a href="https://rust-embedded.github.io/book/intro/index.html">embedded rust book</a>. The code in the post is compiled on a Linux machine (Arch linux) with Rust compiler version: <code class="language-text">rustc 1.47.0-nightly (22ee68dc5 2020-08-05)</code>.</p>
<hr>
<p>We'll take a whirlwind tour on how to run Rust on the Arduino Uno, which is probably the most widely known and used development board in the hobbyist embedded domain. The <a href="https://store.arduino.cc/usa/arduino-uno-rev3">Arduino Uno</a> is based on the ATmega328P, which is an 8 bit microcontroller falling under the family AVR. AVR is a family of micro-controllers developed since 1996 by Atmel, which was later acquired by Microchip technology. If you wanna read more about that, head over here: <a href="https://book.avr-rust.com/001-introduction.html">AVR-Rust book</a></p>
<p>With that brief history aside, let's get into it!</p>
<p>We'll do the hello world of arduino which is blinking its built-in LED. It's a very simple exercise, but there's a lot to learn as a beginner.</p>
<h2><a href="#setting-up-our-project">Setting up our project</a></h2>
<p>First, we'll create a new cargo project by running:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">cargo new rust-arduino-blink</code></pre></div>
<p>We'll need to cross compile our project for the avr target (target triple:<code class="language-text">avr-unknown-unknown</code>).
For this we'll need to switch to the nightly toolchain as some of the dependent crates use unstable features to make all of this happen. So we'll run:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">rustup override <span class="token builtin class-name">set</span> nightly</code></pre></div>
<p>The above command overrides the toolchain of choice for only our current directory to be nightly.</p>
<p>Then we'll install the required packages:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">pacman -S avr-gcc</code></pre></div>
<p>The <code class="language-text">avr-gcc</code> package is required to use the linker.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">pacman -S arduino-avr-core</code></pre></div>
<p>The <code class="language-text">arduino-avr-core</code> package contains utilities such as <a href="https://www.nongnu.org/avrdude/">avrdude</a> which is a tool to upload and manipulate ROM and EEPROM contents of microcontrollers using the in-system programming technique.</p>
<p>I am on an arch linux distro (endeavour OS) where <code class="language-text">pacman</code> is our package manager.</p>
<p>Then, under <code class="language-text">Cargo.toml</code> we'll add the following dependencies:</p>
<div class="gatsby-highlight" data-language="toml"><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token comment"># A panic handler is needed.  This is a crate with the most basic one.</span>
<span class="token key property">panic-halt</span> <span class="token punctuation">=</span> <span class="token string">"0.2.0"</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies.arduino-uno</span><span class="token punctuation">]</span>
<span class="token key property">git</span> <span class="token punctuation">=</span> <span class="token string">"https://github.com/Rahix/avr-hal"</span></code></pre></div>
<p><code class="language-text">avr-hal</code> is a cargo workspace that contains a bunch of crates segregated by boards where the <code class="language-text">arduino-uno</code> crate is one
of them. Thanks to <a href="https://github.com/Rahix/avr-hal">Rahix</a> for putting this together.</p>
<p>We'll also need to add build metadata for cargo for the avr target. We'll create a file <code class="language-text">avr-atmega328p.json</code> in our project root with the following contents:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"llvm-target"</span><span class="token operator">:</span> <span class="token string">"avr-unknown-unknown"</span><span class="token punctuation">,</span>
    <span class="token property">"cpu"</span><span class="token operator">:</span> <span class="token string">"atmega328p"</span><span class="token punctuation">,</span>
    <span class="token property">"target-endian"</span><span class="token operator">:</span> <span class="token string">"little"</span><span class="token punctuation">,</span>
    <span class="token property">"target-pointer-width"</span><span class="token operator">:</span> <span class="token string">"16"</span><span class="token punctuation">,</span>
    <span class="token property">"target-c-int-width"</span><span class="token operator">:</span> <span class="token string">"16"</span><span class="token punctuation">,</span>
    <span class="token property">"os"</span><span class="token operator">:</span> <span class="token string">"unknown"</span><span class="token punctuation">,</span>
    <span class="token property">"target-env"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"target-vendor"</span><span class="token operator">:</span> <span class="token string">"unknown"</span><span class="token punctuation">,</span>
    <span class="token property">"arch"</span><span class="token operator">:</span> <span class="token string">"avr"</span><span class="token punctuation">,</span>
    <span class="token property">"data-layout"</span><span class="token operator">:</span> <span class="token string">"e-P1-p:16:8-i8:8-i16:8-i32:8-i64:8-f32:8-f64:8-n8-a:8"</span><span class="token punctuation">,</span>
  
    <span class="token property">"executables"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  
    <span class="token property">"linker"</span><span class="token operator">:</span> <span class="token string">"avr-gcc"</span><span class="token punctuation">,</span>
    <span class="token property">"linker-flavor"</span><span class="token operator">:</span> <span class="token string">"gcc"</span><span class="token punctuation">,</span>
    <span class="token property">"pre-link-args"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"gcc"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"-Os"</span><span class="token punctuation">,</span> <span class="token string">"-mmcu=atmega328p"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"exe-suffix"</span><span class="token operator">:</span> <span class="token string">".elf"</span><span class="token punctuation">,</span>
    <span class="token property">"post-link-args"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"gcc"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"-Wl,--gc-sections"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
    <span class="token property">"singlethread"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"no-builtins"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  
    <span class="token property">"no-default-libraries"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  
    <span class="token property">"eh-frame-header"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  </code></pre></div>
<p>and reference it in <code class="language-text">.cargo/config.toml</code>:</p>
<div class="gatsby-highlight" data-language="toml"><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">build</span><span class="token punctuation">]</span>
<span class="token key property">target</span> <span class="token punctuation">=</span> <span class="token string">"avr-atmega328p.json"</span>

<span class="token punctuation">[</span><span class="token table class-name">unstable</span><span class="token punctuation">]</span>
<span class="token key property">build-std</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"core"</span><span class="token punctuation">]</span></code></pre></div>
<p>With that, our build configuration is complete.</p>
<h2><a href="#lets-write-some-code">Let's write some code</a></h2>
<p>With the dependencies aside, let's add code under <code class="language-text">main.rs</code> and go through it incrementally:</p>
<p>(Quick tip: You can run <code class="language-text">cargo doc --open</code> in your directory and have a documentation of this project along with its dependencies for ready reference)</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token comment">// main.rs</span>

<span class="token attribute attr-name">#![no_std]</span>
<span class="token attribute attr-name">#![no_main]</span></code></pre></div>
<p>First we need to specify a few global attributes to let the compiler know that we are in a different environment.
We are in an embedded environment which doesn't have functionalities that the <a href="https://github.com/rust-lang/rust/tree/5b04bbfcbb79ed7325ea2b580458a80d95da6bbb/library/std">standard library crate</a> of Rust depends on such as heap allocation APIs, threads, network APIs etc. So we need to add the <code class="language-text">#[no_std]</code> attribute at the top. We also need to override the default entry point (<code class="language-text">fn main()</code>) using <code class="language-text">#[no_main]</code> because we are going to be providing and defining our own entry point to the program. To define our entry point, we'll use the entry attribute macro from the <code class="language-text">arduino_uno</code> crate to define a custom entry point. Usually the board crate you use will provide an entry macro to you.</p>
<p>We then add <code class="language-text">use</code> statements to bring the required items in scope from the dependant crates.</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">extern</span> <span class="token keyword">crate</span> panic_halt<span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>hal<span class="token punctuation">::</span>port<span class="token punctuation">::</span>portb<span class="token punctuation">::</span>PB5<span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>hal<span class="token punctuation">::</span>port<span class="token punctuation">::</span>mode<span class="token punctuation">::</span>Output<span class="token punctuation">;</span></code></pre></div>
<p>Notice the <code class="language-text">panic_halt</code> crate? We need a panic handler because:</p>
<p>In the standard library panicking has a defined behavior: it unwinds the stack of the panicking thread, unless the user opted for aborting the program on panics. In programs without standard library, however, the panicking behavior is left undefined. A behavior can be chosen by declaring a #[panic_handler] function. Source: [<a href="https://rust-embedded.github.io/book/start/panicking.html">embedded rust book</a>]</p>
<p>Let's move on:</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[arduino_uno::entry]</span>
<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span></code></pre></div>
<p>Then we have our <code class="language-text">main</code> function annotated with the <code class="language-text">entry</code> attribute macro from the <code class="language-text">arduino_uno</code> crate. The <code class="language-text">!</code> is
the never type which denotes that the function never returns. </p>
<p>To blink the LED, we only need a few lines of code and set the relevant pin high or low. Let's take a look at the pin diagram of the ATmega328P chip on Uno:</p>
<p><img src="https://components101.com/sites/default/files/inline-images/ATMega328P-Arduino-Uno-Pin-Mapping.png" alt="ATmega328P chip diagram"></p>
<p>In the diagram above, you can notice various pins on the microcontroller. Most microcontrollers, if not all, contain pins that allow the device to both read and write digital values to external circuits. Some of them are categorized as I/O ports.
A port is a group of pins representing a standard interface. These ports are controlled by port registers, which can be thought of as a special byte variable that we can change in our code.</p>
<p>In case of ATmega328P, we have three port registers to work with:</p>
<ul>
<li>C â€“ for analogue pins 0 to 5</li>
<li>D â€“ for digital pins 0 to 7</li>
<li>B â€“ for digital pins 8 to 13</li>
</ul>
<p>The details are explained better here: <a href="https://www.arduino.cc/en/Reference/PortManipulation">Port Manipulation</a></p>
<p>If you look at the Uno, we have the digital Pin 13 which is connected to the built-in LED.
We need access to the pin in our code in order to manipulate the LED, i.e., set it high or low.</p>
<p>Let's add more code:</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[arduino_uno::entry]</span>
<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> peripherals <span class="token operator">=</span> arduino_uno<span class="token punctuation">::</span>Peripherals<span class="token punctuation">::</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> pins <span class="token operator">=</span> arduino_uno<span class="token punctuation">::</span>Pins<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>
        peripherals<span class="token punctuation">.</span>PORTB<span class="token punctuation">,</span>
        peripherals<span class="token punctuation">.</span>PORTC<span class="token punctuation">,</span>
        peripherals<span class="token punctuation">.</span>PORTD<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> led <span class="token operator">=</span> pins<span class="token punctuation">.</span>d13<span class="token punctuation">.</span><span class="token function">into_output</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> pins<span class="token punctuation">.</span>ddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        <span class="token function">stutter_blink</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> led<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>There's a lot going on in the code above!</p>
<p>First, we create an instance of <code class="language-text">Peripherals</code> which is a list of all peripherals in Uno.
Peripherals are devices that bridge the communication with your chip/cpu with external devices, sensors etc.
Examples of peripherals would be your timers, counters, serial port etc.
An embedded processor interacts with a peripheral device through a set of control and status registers.</p>
<p>We then create a new <code class="language-text">Pin</code> instance passing in the ports from the peripheral instance <code class="language-text">peripherals</code>.
We then define a variable <code class="language-text">led</code> that will hold the pin number that the LED is connected to. This is created by configuring pin 13 as output pin using the <code class="language-text">into_output</code> method of the <code class="language-text">d13</code> pin and passing in a mutable reference to our <code class="language-text">ddr</code> register.</p>
<p>DDR register determines if pins on a specific port are inputs or outputs. The DDR register is 8 bits long and each bit corresponds to a pin on that I/O port. For example, the first bit (bit 0) of DDRB will determine if PB0 is an input or output, while the last bit (bit 7) will determine if PB7 is an input or output. I still need to do a bit more reading to fully understand DDR registers.</p>
<p>Next, we go into a <code class="language-text">loop {}</code> and call <code class="language-text">stutter_blink</code> function providing a mutable reference to our <code class="language-text">led</code> instance
and number of times (<code class="language-text">25</code>) that we want to blink.</p>
<p>Here's our <code class="language-text">stutter_blink</code> function definition:</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">stutter_blink</span><span class="token punctuation">(</span>led<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> PB5<span class="token operator">&lt;</span>Output<span class="token operator">></span><span class="token punctuation">,</span> times<span class="token punctuation">:</span> usize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>times<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>i<span class="token operator">|</span> i <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token punctuation">|</span>i<span class="token punctuation">|</span></span> <span class="token punctuation">{</span>
        led<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">void_unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arduino_uno<span class="token punctuation">::</span><span class="token function">delay_ms</span><span class="token punctuation">(</span>i <span class="token keyword">as</span> u16<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>All we do in <code class="language-text">stutter_blink</code> is call toggle on <code class="language-text">led</code> followed by a <code class="language-text">delay_ms</code> call from the <code class="language-text">arduino_uno</code> module.
This is all done in an iterator. We create a range <code class="language-text">(0..times)</code> followed by calling <code class="language-text">map</code> so that we can progressively delay the LED toggle by a noticeable amount. We could have definitely done this using a for loop and that would be more readable, but I wanted to demonstrate that we can use all the high level APIs and abstractions from Rust.
We are writing functional code for an embedded systems where the abstractions are zero cost.
That's a thing possible only in Rust as far as I know!</p>
<p>Here's the full code:</p>
<div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token comment">// main.rs</span>

<span class="token attribute attr-name">#![no_std]</span>
<span class="token attribute attr-name">#![no_main]</span>

<span class="token keyword">extern</span> <span class="token keyword">crate</span> panic_halt<span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>hal<span class="token punctuation">::</span>port<span class="token punctuation">::</span>portb<span class="token punctuation">::</span>PB5<span class="token punctuation">;</span>
<span class="token keyword">use</span> arduino_uno<span class="token punctuation">::</span>hal<span class="token punctuation">::</span>port<span class="token punctuation">::</span>mode<span class="token punctuation">::</span>Output<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function">stutter_blink</span><span class="token punctuation">(</span>led<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> PB5<span class="token operator">&lt;</span>Output<span class="token operator">></span><span class="token punctuation">,</span> times<span class="token punctuation">:</span> usize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>times<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>i<span class="token operator">|</span> i <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token punctuation">|</span>i<span class="token punctuation">|</span></span> <span class="token punctuation">{</span>
        led<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">void_unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arduino_uno<span class="token punctuation">::</span><span class="token function">delay_ms</span><span class="token punctuation">(</span>i <span class="token keyword">as</span> u16<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[arduino_uno::entry]</span>
<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> peripherals <span class="token operator">=</span> arduino_uno<span class="token punctuation">::</span>Peripherals<span class="token punctuation">::</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> pins <span class="token operator">=</span> arduino_uno<span class="token punctuation">::</span>Pins<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>
        peripherals<span class="token punctuation">.</span>PORTB<span class="token punctuation">,</span>
        peripherals<span class="token punctuation">.</span>PORTC<span class="token punctuation">,</span>
        peripherals<span class="token punctuation">.</span>PORTD<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> led <span class="token operator">=</span> pins<span class="token punctuation">.</span>d13<span class="token punctuation">.</span><span class="token function">into_output</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> pins<span class="token punctuation">.</span>ddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        <span class="token function">stutter_blink</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> led<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Let's try to build this crate:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">cargo build</code></pre></div>
<p>If all went fine, you should see an elf file  <code class="language-text">rust-arduino-blink.elf</code> generated under <code class="language-text">target/avr-atmega328p/debug/</code> directory. That's the binary we need to flash to our Uno. To flash the elf file, we'll use the <code class="language-text">avrdude</code> utility. Let's create a script at the root directory named <code class="language-text">flash.sh</code> that does <code class="language-text">cargo build</code> followed by flashing it our uno:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#! /usr/bin/zsh</span>

<span class="token builtin class-name">set</span> -e

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">=</span> <span class="token string">"--help"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">=</span> <span class="token string">"-h"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"usage: <span class="token variable">$0</span> &lt;path-to-binary.elf>"</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;2</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> -lt <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$0</span>: Expecting a .elf file"</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;2</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token function">sudo</span> -u creativcoder cargo build
avrdude -q -C/etc/avrdude.conf -patmega328p -carduino -P/dev/ttyACM0 -D <span class="token string">"-Uflash:w:<span class="token variable">$1</span>:e"</span></code></pre></div>
<p>With that, we can now run (make sure your Uno is connected via the USB cable):</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./flash.sh target/avr-atmega328p/debug/rust-arduino-blink.elf</code></pre></div>
<p>and there you go:</p>
<p><img src="https://media.giphy.com/media/gFtGud1j5fNAl5yzlu/giphy.gif" alt="Rust on arduino"></p>
<p>Our first blinking program on Arduino running Rust!</p>
<p>If you get a permission denied error when accessing <code class="language-text">/dev/ttyACM0</code>. You may need to add your user
to a linux user group that has access to the serial interface.
First, we find the group using:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ls</span> -l /dev/ttyACM0</code></pre></div>
<p>I get the following output on my machine:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">crw-rw---- <span class="token number">1</span> root uucp <span class="token number">166</span>, <span class="token number">0</span> Aug <span class="token number">19</span> 03:29 /dev/ttyACM0</code></pre></div>
<p>To add your username to <code class="language-text">uucp</code> group, we run:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> -a -G uucp creativcoder</code></pre></div>
<p>Suggestions/comments/corrections most welcome.</p>
<p>I have several embedded hobby projects in plan, I will be writing about them in future as they progress. Here's the <a href="https://github.com/creativcoder/rust-arduino-blink">Github</a> for the code above.
If you want to follow the latest in developement in Rust embedded space, follow the <a href="https://rust-embedded.github.io/blog/newsletter-24/">embedded rust working group</a></p>
<p>Until next time!</p></div><div class="navigation-module--navigation--3Zfju"><span class="navigation-module--button--28kp3"><a href="/setup-nextjs-tailwind"><span class="navigation-module--iconPrev--23mg1">â†</span><span class="navigation-module--buttonText--1Xod2">How to setup NextJS with TailwindCSS ðŸŒŠ</span></a></span><span class="navigation-module--button--28kp3"><a href="/how-to-add-github-utterances-blog"><span class="navigation-module--buttonText--1Xod2">How to add comment support on your Gatsby blog using Github utterances</span><span class="navigation-module--iconNext--3xyJ-">â†’</span></a></span></div><div class="comments"></div></div></div></div><footer><div><p>Hey, welcome! I write about Rust, Web, Backend engineering, Distributed systems and more. <br/>Want to stay updated on my next post? Consider subscribing!</p><iframe src="https://creativcoder.substack.com/embed" width="380" height="320" frameBorder="0" scrolling="no"></iframe></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/rust-on-arduino-uno";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-b48090a5057dc339fe46.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0a693de524cfe795e0c4.js"],"component---src-templates-index-js":["/component---src-templates-index-js-85745c63d1f104ded21b.js"],"component---src-templates-page-js":["/component---src-templates-page-js-dbf26a7cadf695539444.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-9850dc851140f5571b03.js"]};/*]]>*/</script><script src="/component---src-templates-page-js-dbf26a7cadf695539444.js" async=""></script><script src="/23c3d3a3a2879427593569aafa02d04d4d5b9e2a-02d3ce6bc7398bea4d02.js" async=""></script><script src="/commons-23c2adbaf89b8510e10b.js" async=""></script><script src="/styles-0dd9b16d06f2e4f550cc.js" async=""></script><script src="/app-b48090a5057dc339fe46.js" async=""></script><script src="/framework-f2db165fb1960f050581.js" async=""></script><script src="/webpack-runtime-0d2cb20de6c72e8ed401.js" async=""></script></body></html>